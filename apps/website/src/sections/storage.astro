---
import {
    LuCircleCheck,
    LuDatabase,
    LuSearch,
    LuTrendingUp,
    LuFileText,
    LuImage,
    LuLock,
    LuLink,
    LuShieldCheck,
} from "react-icons/lu";
---

<section
    id="storage"
    data-c1="hsl(200 90% 60% / .10)"
    data-c2="hsl(150 80% 60% / .10)"
    class="relative mx-auto max-w-7xl px-4 py-28 lg:px-8 mb-6"
>
    <!-- soft grid bg -->
    <div aria-hidden="true" class="pointer-events-none absolute inset-0">
        <div
            class="absolute inset-0 bg-[linear-gradient(to_right,theme(colors.muted.DEFAULT/.12)_1px,transparent_1px),linear-gradient(to_bottom,theme(colors.muted.DEFAULT/.12)_1px,transparent_1px)] bg-[size:36px_36px]"
        >
        </div>
    </div>

    <div class="relative z-10">
        <div class="mx-auto max-w-4xl text-center">
            <div
                class="inline-flex items-center gap-2 rounded-full border border-sky-500/20 bg-sky-500/10 backdrop-blur-sm px-4 py-2 text-sm font-medium text-sky-700 dark:text-sky-300 mb-6"
            >
                Storage & Search — Built-in
            </div>

            <h2
                class="text-4xl font-bold sm:text-5xl lg:text-6xl bg-gradient-to-r from-foreground via-sky-500 to-violet-500 bg-clip-text text-transparent"
            >
                Files, tables, and search — right on the canvas
            </h2>

            <p class="mt-6 text-lg text-muted-foreground max-w-3xl mx-auto">
                Save files, keep records, and find things fast — all inside your
                flow. No extra services to wire up. Plug a node in, and your
                data is ready to use.
            </p>
        </div>

        <!-- Stage -->
        <div class="mx-auto mt-16 max-w-6xl">
            <div
                class="stage rounded-3xl border border-border/40 backdrop-blur-sm overflow-hidden"
            >
                <!-- Top tabs -->
                <div
                    id="store-tabs"
                    role="tablist"
                    aria-label="Storage demos"
                    class="relative grid grid-cols-3 gap-2 p-3"
                >
                    <span
                        id="store-indicator"
                        class="absolute top-3 left-3 h-[calc(100%-24px)] rounded-2xl border border-border/60 bg-muted/60 backdrop-blur-sm transition-[transform,width] duration-300 ease-out will-change-transform pointer-events-none"
                    ></span>

                    <button
                        role="tab"
                        aria-controls="pane-files"
                        aria-selected="true"
                        data-target="files"
                        class="store-tab relative z-10 rounded-2xl px-4 py-3 text-sm font-semibold"
                    >
                        <span class="flex items-center justify-center gap-2">
                            <span
                                class="w-8 h-8 rounded-lg flex items-center justify-center bg-gradient-to-br from-sky-500 to-cyan-500"
                            >
                                <LuDatabase className="w-4 h-4 text-white" />
                            </span>
                            <span class="tab-text">Files</span>
                        </span>
                    </button>

                    <button
                        role="tab"
                        aria-controls="pane-tables"
                        aria-selected="false"
                        data-target="tables"
                        class="store-tab relative z-10 rounded-2xl px-4 py-3 text-sm font-semibold"
                    >
                        <span class="flex items-center justify-center gap-2">
                            <span
                                class="w-8 h-8 rounded-lg flex items-center justify-center bg-gradient-to-br from-emerald-500 to-green-500"
                            >
                                <LuCircleCheck className="w-4 h-4 text-white" />
                            </span>
                            <span class="tab-text">Tables</span>
                        </span>
                    </button>

                    <button
                        role="tab"
                        aria-controls="pane-search"
                        aria-selected="false"
                        data-target="search"
                        class="store-tab relative z-10 rounded-2xl px-4 py-3 text-sm font-semibold"
                    >
                        <span class="flex items-center justify-center gap-2">
                            <span
                                class="w-8 h-8 rounded-lg flex items-center justify-center bg-gradient-to-br from-indigo-500 to-purple-500"
                            >
                                <LuSearch className="w-4 h-4 text-white" />
                            </span>
                            <span class="tab-text">Search</span>
                        </span>
                    </button>
                </div>

                <!-- grid: demo | copy -->
                <div
                    class="grid lg:grid-cols-[1.1fr_1fr] gap-0 border-t border-border/40"
                >
                    <!-- DEMO -->
                    <div class="relative p-4 lg:p-6">
                        <div class="h-[min(60vh,560px)] min-h-[360px]">
                            <!-- FILES -->
                            <div
                                id="pane-files"
                                role="tabpanel"
                                aria-hidden="false"
                                class="pane data-[state=active]:opacity-100 data-[state=active]:translate-y-0"
                            >
                                <div class="card">
                                    <header class="card-h">
                                        <span class="muted">workspace/</span><b
                                            >project-files/</b
                                        >
                                        <span
                                            class="muted ml-auto flex items-center gap-2 text-xs"
                                        >
                                            <LuLock className="w-3.5 h-3.5" /> secure
                                            links
                                        </span>
                                    </header>
                                    <ul class="file-list">
                                        <li>
                                            <span class="badge"
                                                ><LuImage
                                                    className="w-3.5 h-3.5"
                                                /> photo.webp</span
                                            >
                                            <span class="meta"
                                                >1280×720 • 84 KB</span
                                            >
                                        </li>
                                        <li>
                                            <span class="badge"
                                                ><LuFileText
                                                    className="w-3.5 h-3.5"
                                                /> invoice.pdf</span
                                            >
                                            <span class="meta"
                                                ><LuLink
                                                    className="inline -mt-0.5"
                                                /> shareable link</span
                                            >
                                        </li>
                                        <li>
                                            <span class="badge"
                                                ><LuImage
                                                    className="w-3.5 h-3.5"
                                                /> claim.jpg</span
                                            >
                                            <span class="meta"
                                                >high-res • streams smoothly</span
                                            >
                                        </li>
                                        <li>
                                            <span class="badge"
                                                ><LuFileText
                                                    className="w-3.5 h-3.5"
                                                /> notes.txt</span
                                            >
                                            <span class="meta"
                                                >tiny • cached</span
                                            >
                                        </li>
                                    </ul>
                                    <footer class="card-f">
                                        <span class="chip" data-tint="sky"
                                            >Read</span
                                        >
                                        <span class="chip" data-tint="violet"
                                            >Transform</span
                                        >
                                        <span class="chip" data-tint="emerald"
                                            >Write</span
                                        >
                                        <span class="chip" data-tint="amber"
                                            >Share securely</span
                                        >
                                    </footer>
                                </div>
                            </div>

                            <!-- TABLES -->
                            <div
                                id="pane-tables"
                                role="tabpanel"
                                aria-hidden="true"
                                class="pane"
                            >
                                <div class="card">
                                    <header class="card-h">
                                        <b>claims</b>
                                        <span class="muted">records</span>
                                        <span
                                            class="muted ml-auto flex items-center gap-2 text-xs"
                                        >
                                            <LuShieldCheck
                                                className="w-3.5 h-3.5"
                                            /> checks pass
                                        </span>
                                    </header>
                                    <div class="table">
                                        <div class="t-row t-h">
                                            <div>ID</div><div>customer</div><div
                                            >
                                                amount
                                            </div><div>status</div>
                                        </div>
                                        <div class="t-row">
                                            <div>10023</div><div>c_491</div><div
                                            >
                                                € 489.00
                                            </div><div>
                                                <span class="pill ok"
                                                    >approved</span>
                                            </div>
                                        </div>
                                        <div class="t-row">
                                            <div>10024</div><div>c_812</div><div
                                            >
                                                € 79.00
                                            </div><div>
                                                <span class="pill warn"
                                                    >review</span>
                                            </div>
                                        </div>
                                        <div class="t-row">
                                            <div>10025</div><div>c_901</div><div
                                            >
                                                € 129.00
                                            </div><div>
                                                <span class="pill"
                                                    >pending</span>
                                            </div>
                                        </div>
                                    </div>
                                    <footer class="card-f">
                                        <span class="chip" data-tint="indigo"
                                            >Preflight</span
                                        >
                                        <span class="chip" data-tint="blue"
                                            >Typed query</span
                                        >
                                        <span class="chip" data-tint="slate"
                                            >Paginate</span
                                        >
                                    </footer>
                                </div>
                            </div>

                            <!-- SEARCH -->
                            <div
                                id="pane-search"
                                role="tabpanel"
                                aria-hidden="true"
                                class="pane"
                            >
                                <div class="card">
                                    <header class="card-h">
                                        <b>Smart search</b>
                                        <span class="muted"
                                            >Mix keyword, vector, and filters</span
                                        >
                                    </header>

                                    <!-- simple toggles -->
                                    <div
                                        class="togglebar"
                                        role="group"
                                        aria-label="Search options"
                                    >
                                        <button
                                            class="toggle is-on"
                                            data-k="vec"
                                            aria-pressed="true"
                                            ><span class="dot"></span> Vector</button
                                        >
                                        <button
                                            class="toggle is-on"
                                            data-k="fts"
                                            aria-pressed="true"
                                            ><span class="dot"></span> Keyword</button
                                        >
                                        <button
                                            class="toggle is-on"
                                            data-k="sql"
                                            aria-pressed="true"
                                            ><span class="dot"></span> Filters</button
                                        >
                                    </div>

                                    <!-- tiny graph -->
                                    <div
                                        id="search-graph"
                                        class="mini-graph"
                                        data-vec="1"
                                        data-fts="1"
                                        data-sql="1"
                                    >
                                        <svg
                                            viewBox="0 0 640 220"
                                            aria-hidden="true"
                                        >
                                            <!-- edges -->
                                            <path
                                                class="edge base"
                                                d="M 100 70 C 140 70, 150 70, 190 70"
                                            ></path>
                                            <path
                                                class="edge vec"
                                                d="M 310 70 C 340 70, 330 70, 360 70"
                                            ></path>
                                            <path
                                                class="edge fts"
                                                d="M 100 70 C 170 70, 290 150, 360 150"
                                            ></path>
                                            <path
                                                class="edge vec"
                                                d="M 430 70 C 480 90, 480 90, 520 100"
                                            ></path>
                                            <path
                                                class="edge fts"
                                                d="M 430 150 C 480 130, 480 130, 520 120"
                                            ></path>
                                            <path
                                                class="edge sql"
                                                d="M 560 120 C 580 140, 580 150, 590 160"
                                            ></path>

                                            <!-- nodes -->
                                            <rect
                                                class="node base"
                                                x="40"
                                                y="40"
                                                width="120"
                                                height="60"
                                                rx="12"></rect>
                                            <text
                                                class="label"
                                                x="100"
                                                y="75"
                                                text-anchor="middle">Input</text
                                            >

                                            <rect
                                                class="node vec"
                                                x="190"
                                                y="40"
                                                width="120"
                                                height="60"
                                                rx="12"></rect>
                                            <text
                                                class="label"
                                                x="250"
                                                y="75"
                                                text-anchor="middle">Embed</text
                                            >

                                            <rect
                                                class="node vec"
                                                x="360"
                                                y="40"
                                                width="120"
                                                height="60"
                                                rx="12"></rect>
                                            <text
                                                class="label"
                                                x="420"
                                                y="75"
                                                text-anchor="middle"
                                                >Similar</text
                                            >

                                            <rect
                                                class="node fts"
                                                x="360"
                                                y="120"
                                                width="120"
                                                height="60"
                                                rx="12"></rect>
                                            <text
                                                class="label"
                                                x="420"
                                                y="155"
                                                text-anchor="middle"
                                                >Keyword</text
                                            >

                                            <rect
                                                class="node merge"
                                                x="500"
                                                y="90"
                                                width="80"
                                                height="40"
                                                rx="10"></rect>
                                            <text
                                                class="label"
                                                x="540"
                                                y="115"
                                                text-anchor="middle">Merge</text
                                            >

                                            <rect
                                                class="node sql"
                                                x="560"
                                                y="140"
                                                width="80"
                                                height="40"
                                                rx="10"></rect>
                                            <text
                                                class="label"
                                                x="600"
                                                y="165"
                                                text-anchor="middle"
                                                >Filter</text
                                            >
                                        </svg>
                                    </div>

                                    <!-- results -->
                                    <ul class="results">
                                        <li>
                                            <span class="title"
                                                >“warranty claim approved for
                                                unit A12”</span
                                            >
                                            <span class="score"
                                                >high match • combined search</span
                                            >
                                            <p class="snippet">
                                                …triage complete — <mark
                                                    >approval</mark
                                                > granted based on photo evidence…
                                            </p>
                                        </li>
                                        <li>
                                            <span class="title"
                                                >“declined: missing receipt”</span
                                            >
                                            <span class="score"
                                                >good match • filtered</span
                                            >
                                            <p class="snippet">
                                                …request <mark>declined</mark> due
                                                to missing documentation…
                                            </p>
                                        </li>
                                    </ul>

                                    <footer class="card-f">
                                        <span class="chip" data-tint="emerald"
                                            >Vector</span
                                        >
                                        <span class="chip" data-tint="violet"
                                            >Keyword</span
                                        >
                                        <span class="chip" data-tint="amber"
                                            >Filters</span
                                        >
                                    </footer>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- COPY / BENEFITS -->
                    <div class="relative p-4 lg:p-6">
                        <div
                            class="h-[min(56vh,520px)] min-h-[360px] flex flex-col px-2"
                        >
                            <h3 class="text-2xl font-semibold">
                                Storage that comes ready to use
                            </h3>
                            <p class="mt-3 text-muted-foreground">
                                Upload a file, store a record, or search across
                                both — without leaving the workflow. Everything
                                stays connected to the steps that used it, so
                                you can explain results later.
                            </p>

                            <div class="mt-6 grid grid-cols-2 gap-3 text-sm">
                                <div class="benefit">
                                    <span class="emoji">⚡</span> Stream files and
                                    process them in place
                                </div>
                                <div class="benefit">
                                    <span class="emoji">🧾</span> Checks that keep
                                    data shape consistent
                                </div>
                                <div class="benefit">
                                    <span class="emoji">🔐</span> Secure links &
                                    scoped access
                                </div>
                                <div class="benefit">
                                    <span class="emoji">♻️</span> Smart caching for
                                    faster runs
                                </div>
                                <div class="benefit">
                                    <span class="emoji">🧠</span> Keyword + vector
                                    search together
                                </div>
                                <div class="benefit">
                                    <span class="emoji">📦</span> Works local or
                                    with your cloud storage
                                </div>
                            </div>

                            <div
                                class="mt-auto pt-6 flex flex-wrap gap-2 text-sm"
                            >
                                <span class="chip hi" data-tint="sky"
                                    >∞ Files</span
                                >
                                <span class="chip hi" data-tint="emerald"
                                    >∞ Tables</span
                                >
                                <span class="chip hi" data-tint="violet"
                                    >Keyword + Vector</span
                                >
                                <span class="chip" data-tint="amber"
                                    ><LuTrendingUp
                                        className="w-3.5 h-3.5 -mt-0.5"
                                    /> Hybrid queries</span
                                >
                                <span class="chip" data-tint="slate"
                                    >Inline in workflows</span
                                >
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- /stage -->
        </div>
    </div>
</section>

<script type="module">
    (() => {
        /** @type {"files"|"tables"|"search"} */
        let current = "files";

        const tablist = document.getElementById("store-tabs");
        if (!tablist) return;

        /** @type {HTMLButtonElement[]} */
        const tabs = Array.from(tablist.querySelectorAll('[role="tab"]'));
        const panes = {
            files: document.getElementById("pane-files"),
            tables: document.getElementById("pane-tables"),
            search: document.getElementById("pane-search"),
        };
        const indicator = document.getElementById("store-indicator");

        const setActive = (key) => {
            current = key;
            tabs.forEach((t) =>
                t.setAttribute(
                    "aria-selected",
                    String(t.dataset.target === key),
                ),
            );
            Object.entries(panes).forEach(([k, el]) => {
                if (!el) return;
                el.dataset.state = k === key ? "active" : "inactive";
                el.setAttribute("aria-hidden", String(k !== key));
            });

            // move indicator (hidden on mobile via CSS)
            const active = tabs.find((t) => t.dataset.target === key);
            if (active && indicator) {
                indicator.style.width = `${active.offsetWidth}px`;
                indicator.style.transform = `translateX(${active.offsetLeft}px)`;
            }
        };

        // init
        setActive(
            tabs.find((t) => t.getAttribute("aria-selected") === "true")
                ?.dataset.target ?? "files",
        );

        // click
        tabs.forEach((btn) =>
            btn.addEventListener("click", () => setActive(btn.dataset.target)),
        );

        // keyboard
        tablist.addEventListener("keydown", (e) => {
            const i = tabs.findIndex(
                (t) => t.getAttribute("aria-selected") === "true",
            );
            let n = i;
            switch (e.key) {
                case "ArrowRight":
                    n = (i + 1) % tabs.length;
                    break;
                case "ArrowLeft":
                    n = (i - 1 + tabs.length) % tabs.length;
                    break;
                case "Home":
                    n = 0;
                    break;
                case "End":
                    n = tabs.length - 1;
                    break;
                case "Enter":
                case " ":
                    e.preventDefault();
                    setActive(tabs[i].dataset.target);
                    return;
                default:
                    return;
            }
            e.preventDefault();
            tabs[n].focus();
            setActive(tabs[n].dataset.target);
        });

        // search toggles
        const graph = document.getElementById("search-graph");
        const toggles = Array.from(
            document.querySelectorAll(".togglebar .toggle"),
        );
        const setToggle = (k, on) => {
            if (!graph) return;
            graph.dataset[k] = on ? "1" : "0";
            const btn = toggles.find((b) => b.dataset.k === k);
            if (btn) btn.setAttribute("aria-pressed", String(on));
        };
        toggles.forEach((btn) => {
            btn.addEventListener("click", () => {
                const k = btn.dataset.k;
                const on = btn.getAttribute("aria-pressed") !== "true";
                setToggle(k, on);
            });
        });

        // keep indicator aligned on resize
        const ro = new ResizeObserver(() => {
            const active = tabs.find(
                (t) => t.getAttribute("aria-selected") === "true",
            );
            if (active && indicator) {
                indicator.style.width = `${active.offsetWidth}px`;
                indicator.style.transform = `translateX(${active.offsetLeft}px)`;
            }
        });
        ro.observe(tablist);
        tabs.forEach((t) => ro.observe(t));
    })();
</script>

<style>
    /* layout + panes */
    .stage {
        --stage-h: min(56vh, 520px);
        background: radial-gradient(
                120% 120% at 15% 5%,
                rgba(255, 255, 255, 0.06),
                transparent 55%
            ),
            linear-gradient(to bottom, rgba(0, 0, 0, 0.08), transparent 40%),
            color-mix(in oklch, var(--card) 34%, transparent);
    }
    .stage > .grid {
        align-items: center;
    }

    .pane {
        position: absolute;
        inset: 0;
        opacity: 0;
        transform: translateY(6px);
        transition:
            opacity 0.22s ease,
            transform 0.22s ease;
        pointer-events: none;
        margin: 0.5rem;
    }
    .pane[data-state="active"] {
        opacity: 1;
        transform: none;
        pointer-events: auto;
    }

    /* cards */
    .card {
        height: 100%;
        display: flex;
        flex-direction: column;
        border-radius: 1.25rem;
        border: 1px solid color-mix(in oklch, var(--border) 60%, transparent);
        background: linear-gradient(
                to bottom right,
                color-mix(in oklch, var(--muted) 6%, transparent),
                transparent
            ),
            color-mix(in oklch, var(--card) 92%, transparent);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        overflow: hidden;
    }
    .card-h,
    .card-f {
        display: flex;
        align-items: center;
        gap: 0.6rem;
        padding: 0.9rem 1rem;
    }
    .card-h {
        border-bottom: 1px solid
            color-mix(in oklch, var(--border) 60%, transparent);
        font-weight: 600;
    }
    .card-f {
        gap: 0.5rem;
        margin-top: auto;
        border-top: 1px solid
            color-mix(in oklch, var(--border) 60%, transparent);
    }

    .muted {
        color: color-mix(in oklch, var(--muted-foreground) 100%, transparent);
    }

    /* chips */
    .chip {
        --c: 215 16% 47%;
        display: inline-flex;
        align-items: center;
        gap: 0.45rem;
        padding: 0.32rem 0.66rem;
        border-radius: 9999px;
        border: 1px solid hsl(var(--c) / 0.38);
        background: hsl(var(--c) / 0.14);
        color: hsl(var(--c) / 0.96);
        font-weight: 600;
        font-size: 0.8rem;
        line-height: 1;
        transition:
            transform 0.15s ease,
            background 0.15s ease,
            border-color 0.15s ease;
    }
    .chip:hover {
        transform: translateY(-1px);
        background: hsl(var(--c) / 0.22);
        border-color: hsl(var(--c) / 0.5);
    }
    .chip.hi {
        background: hsl(var(--c) / 0.22);
        border-color: hsl(var(--c) / 0.5);
    }
    .chip[data-tint="sky"] {
        --c: 199 89% 48%;
    }
    .chip[data-tint="blue"] {
        --c: 213 94% 67%;
    }
    .chip[data-tint="violet"] {
        --c: 263 83% 66%;
    }
    .chip[data-tint="indigo"] {
        --c: 243 85% 64%;
    }
    .chip[data-tint="emerald"] {
        --c: 160 84% 40%;
    }
    .chip[data-tint="amber"] {
        --c: 28 96% 54%;
    }
    .chip[data-tint="slate"] {
        --c: 215 16% 47%;
    }

    /* files list */
    .file-list {
        padding: 0.75rem 1rem;
        display: grid;
        gap: 0.6rem;
    }
    .file-list li {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 1rem;
        padding: 0.55rem 0.7rem;
        border: 1px dashed color-mix(in oklch, var(--border) 60%, transparent);
        border-radius: 0.8rem;
        background: color-mix(in oklch, var(--muted) 12%, transparent);
    }
    .file-list .badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
    }
    .file-list .meta {
        font-size: 0.8rem;
        color: color-mix(in oklch, var(--muted-foreground) 100%, transparent);
        text-align: right;
    }

    /* tables */
    .table {
        padding: 0.75rem 1rem;
        display: grid;
        gap: 0.4rem;
    }
    .t-row {
        display: grid;
        grid-template-columns: 1.2fr 1.2fr 1fr 1fr;
        gap: 0.6rem;
        padding: 0.45rem 0.6rem;
        border-radius: 0.6rem;
        border: 1px solid color-mix(in oklch, var(--border) 50%, transparent);
        background: color-mix(in oklch, var(--muted) 10%, transparent);
    }
    .t-row.t-h {
        font-size: 0.85rem;
        font-weight: 700;
        background: color-mix(in oklch, var(--muted) 18%, transparent);
    }
    .pill {
        padding: 0.1rem 0.45rem;
        border-radius: 0.6rem;
        background: color-mix(in oklch, var(--muted) 28%, transparent);
        font-size: 0.75rem;
        font-weight: 700;
    }
    .pill.ok {
        background: color-mix(in oklch, limegreen 35%, transparent);
    }
    .pill.warn {
        background: color-mix(in oklch, orange 35%, transparent);
    }

    /* toggles */
    .togglebar {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        padding: 0.7rem 1rem 0.2rem;
    }
    .toggle {
        display: inline-flex;
        align-items: center;
        gap: 0.45rem;
        padding: 0.32rem 0.6rem;
        border-radius: 0.7rem;
        font-size: 0.85rem;
        font-weight: 700;
        border: 1px solid color-mix(in oklch, var(--border) 60%, transparent);
        background: color-mix(in oklch, var(--muted) 16%, transparent);
        color: color-mix(in oklch, var(--foreground) 90%, transparent);
        transition:
            transform 0.15s ease,
            background 0.15s ease,
            border-color 0.15s ease;
    }
    .toggle .dot {
        width: 0.5rem;
        height: 0.5rem;
        border-radius: 9999px;
        background: var(--primary);
        opacity: 0.8;
    }
    .toggle:is(:hover, .is-on) {
        transform: translateY(-1px);
    }
    .toggle[aria-pressed="false"] {
        opacity: 0.7;
        background: color-mix(in oklch, var(--muted) 10%, transparent);
    }
    .toggle[aria-pressed="false"] .dot {
        background: var(--muted);
    }

    /* mini graph */
    .mini-graph svg {
        width: 100%;
        height: 220px;
        display: block;
    }
    .mini-graph .node {
        fill: color-mix(in oklch, var(--muted) 100%, transparent);
        stroke: color-mix(in oklch, var(--border) 70%, transparent);
        stroke-width: 1.25;
    }
    .mini-graph .label {
        font-size: 12.5px;
        font-weight: 800;
        fill: color-mix(in oklch, var(--foreground) 92%, transparent);
        paint-order: stroke;
        stroke: rgba(0, 0, 0, 0.55);
        stroke-width: 0.6px;
    }
    .mini-graph .edge {
        fill: none;
        stroke-linecap: round;
        stroke-width: 2;
        stroke-dasharray: 8 8;
        opacity: 0.9;
    }
    @keyframes flow {
        to {
            stroke-dashoffset: -1000;
        }
    }
    .mini-graph .edge.base {
        stroke: hsl(215 16% 60% / 0.8);
    }
    .mini-graph .edge.vec,
    .mini-graph .node.vec {
        stroke: hsl(160 84% 40% / 0.9);
    }
    .mini-graph .edge.fts,
    .mini-graph .node.fts {
        stroke: hsl(263 83% 66% / 0.9);
    }
    .mini-graph .edge.sql,
    .mini-graph .node.sql {
        stroke: hsl(28 96% 54% / 0.9);
    }
    .mini-graph .node.merge {
        stroke: hsl(243 85% 64% / 0.9);
    }
    .mini-graph[data-vec="1"] .edge.vec {
        animation: flow 15s linear infinite;
    }
    .mini-graph[data-fts="1"] .edge.fts {
        animation: flow 15s linear infinite;
        animation-delay: 0.12s;
    }
    .mini-graph[data-sql="1"] .edge.sql {
        animation: flow 15s linear infinite;
        animation-delay: 0.24s;
    }
    .mini-graph[data-vec="0"] .node.vec,
    .mini-graph[data-fts="0"] .node.fts,
    .mini-graph[data-sql="0"] .node.sql {
        fill: var(--card);
        stroke: var(--muted);
    }
    .mini-graph[data-vec="0"] .edge.vec,
    .mini-graph[data-fts="0"] .edge.fts,
    .mini-graph[data-sql="0"] .edge.sql {
        opacity: 0.18;
    }

    /* tabs */
    .store-tab {
        color: color-mix(in oklch, var(--foreground) 82%, transparent);
    }
    .store-tab[aria-selected="true"] {
        color: var(--foreground);
    }
    #store-indicator {
        box-shadow:
            0 0 0 1px color-mix(in oklch, var(--border) 80%, transparent),
            0 6px 24px rgba(0, 0, 0, 0.25);
    }

    /* mobile behavior */

    @media (max-width: 640px) {
        /* keep tabs horizontal; show label only for active tab */
        #store-tabs {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 0.5rem;
        }
        .tab-text {
            display: none;
        }
        .store-tab[aria-selected="true"] .tab-text {
            display: inline;
        }
        .store-tab {
            padding: 0.6rem 0.5rem;
        }
    }
    @media (prefers-reduced-motion: reduce) {
        #store-indicator,
        .pane {
            transition: none !important;
        }
    }
</style>
